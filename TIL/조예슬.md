# ✏️ TIL (Today I Learned)

## 2025.01.20 (월)
### ✅ TO DO
- API 개발 전에 공통으로 필요한 클래스 (Exception, Config..) 구현
- 맡은 API 개발 

### 🔥 What I Learned
- 기존에 해왔던 방식대로 GlobalExceptionHandler 클래스 하나 만들고 @RestControllerAdvice를 통해 컨트롤러단에서 발생하는 에러는 한곳에서 처리하도록 구현했다.
- 그래서 service 단에서 우리가 던지는 예외는 모두 잘 잡혀 커스텀되어 내려가는 것을 확인할 수 있었지만, HTTP 메서드를 다르게 (PostMapping한 API에 DELETE로 요청) 하니 해당 요청은 잡지 못하고 500 에러를 뱉는 걸 확인할 수 있었다.
- 해당 문제에 대해 찾아보고 고민한 결과, 명시하지 않은 예외의 경우 Spring MVC Exception이 터지게 되면서 예상한 시나리오대로 GlobalExceptionHandler에서 잡지 못하는 것이었다. -> 물론 잡게 할 수 있지만 그럼 일일히 다 handling 하는 메서드를 추가해주어야 함.
- 해결 방법으로 ResponseEntityExceptionHandler 라는 클래스에서 Spring MVC Exception에 대한 최소한의 처리를 해주고 있기 때문에 이 클래스를 상속 받아서 구현했다.

<br>

## 2025.01.17 (금)
### ✅ TO DO
- AWS IAM 계정 파서 팀원들에게 공유
- AWS 세팅 완료
- dev DB에 더미 데이터 넣기

### 🔥 What I Learned
- IAM 사용자를 생성해서 우리 EC2와 RDS만 접근할 수 있는 최소한의 권한 범위를 주는 것이 목표였는데, 예상치 못한 이슈가 생겼고 이를 해결하면서 정책 문법에 대해서 배울 수 있었다.
    - Effect -> Allow, Resource를 우리 EC2와 RDS로 하고 Effect -> Deny, Resource를 ec2 전체로 세팅하면 우리 꺼만 허용하고 나머지는 접근할 수 없게 세팅이 될 것이라고 예상했지만 우리 리소스에도 계속해서 접근을 할 수 없었다.
    - 공식 문서를 찾아보니 Deny는 항상 Allow보다 우선 되기 때문에 Deny를 다 하고 특정 리소스를 Allow 한다고 해서 되는게 아니었고,Deny를 할려면 Condition 을 줘서 예외를 정의 해줘야 한다 !
    - 그리고 애초에 디폴트로는 Allow 한 거 빼고 나머지는 안되기 때문에 헷갈리지 않게 Allow 만 쓰는게 좋을 것 같다.

<br>

## 2025.01.16 (목)
### ✅ TO DO
- 디자인 회의
- API 명세서 픽스
- AWS 세팅
- Entity 코드 작성성

### 🔥 What I Learned
- AWS 인프라 세팅 할 때, 보안과 과금 방지를 위해서 default VPC가 아닌 choco-letter라는 가상의 네트워크를 만들고 그 위해 public subnet과 private subnet을 구축했다.
- public subnet에는 EC2를 띄우고 private subnet에는 RDS를 띄웠다. 이렇게 하면 우리의 EC2에서만 RDS를 접근할 수 있게 하여서 보안성을 높일 수 있다는 것을 배웠다.
- 이후 데이터그립 등과 같은 IDE에서 접속이 안되어 불편한 문제는 ssh 터널링을 통해 해결했다.
    - ([데이터그립에서 SSH로 연결하는 방법](https://jojoldu.tistory.com/623))
<br>

- 팀원의 Entity 코드 머지 리뷰를 하면서 생성자 패턴에 대해 고민을 좀 해봤다.
    - 다른 프로젝트에서 나는 '파라미터 순서에 대한 휴먼 에러를 줄일 수 있고, 가독성이 좋으며 필요한 값만 세팅할 수 있어서 유연하다'는 장점으로 빌더 패턴을 사용했다.
    - 하지만 무분별하게 빌더패턴을 쓰는건 빌더객체를 추가로 생성해야하는 오버헤드를 가져올 수 있기 때문에 필드 값이 2-3개로 적을 때는 쓰지 않고 그 이상이거나, 아니면 같은 타입의 필드가 많은 경우에만 사용하기로 했다.
    - 또한 정적 팩토리 패턴은 '생성자에 어떤 역할을 메서드명을 통해 분명하게 명시할 수 있다'는 장점이 있어서 사용을 해왔다. 우리 서비스의 경우 선물이 일반 선물과 특별 선물로 나눠지는데 Entity는 Gift로 같기 때문에 이 두 가지 타입의 선물을 생성하는 생성자를 구별할 수 있으면 좋겠다고 생각했다.
    - 근데 또 빌더 패턴을 사용하는 이유가 그럼 퇴색 된다고 생각했기 때문에 빌더패턴을 쓰며 외부에서 직관적으로 확인할 수 있는 방법이 없을까 ? 고민하게 됐다.
    - 찾아보니 하나의 객체에 여러 빌더를 쓸 수 있는데, 빌더 메서드 명도 다르게 세팅이 가능하단 것을 알았다. 그래서 builderMethodName 옵션과 builderClassName 옵션을 줘서 두 개의 빌더 메서드를 생성하는 방식으로 문제를 해결했다.

<br>

## 2025.01.15 (수)
### ✅ TO DO
- API 명세서 작성
- 기획 디벨롭 및 픽스
- 새로운 기능(채팅 시스템)에 대한 러프한 설계
- JIRA 컨벤션 정의 및 백로그 작성

### 🔥 What I Learned
- AWS 인프라 기본 세팅을 하면서 CS 지식이 진짜 중요하다는 것을 깨달았다..
    - ipv4 고갈 현상으로 인해서 ipv6 사용을 권장하는 목적으로 프리 티어 무료 정책이 변경됨에 따라 EC2까지는 괜찮은데 RDS는 퍼블릭 ipv4를 할당하면 과금이라는 것은 이전부터 알고 있었다.
    - 이번 프로젝트부터는 과금 방지의 목적도 있지만, 보안상 누구나 우리 RDS를 접근하게 하는 것이 아니라 EC2의 보안 그룹을 거친 트래픽만 접근할 수 있도록 세팅하는 것이 좋을 것 같았다.
    - 이렇게 세팅 하기 위해서는 VPC와 서브넷 개념을 아는 것이 우선이라고 생각했고, 두 개념을 공부할 수 있는 기회였다. 이 과정에서 네트워크 지식이 단순히 이론적으로만 필요한 것이 아니라는 것을 배울 수 있었다 !
    - 참고 자료 : ([vpc 개념](https://velog.io/@yenicall/AWS-VPC%EC%9D%98-%EA%B0%9C%EB%85%90))
- 채팅 시스템을 구현할 때, 샌드버드와 같은 Saas를 사용할 수 있다는 것을 컨설턴트님과 미팅을 통해 배울 수 있었다. 한번 더 자세히 찾아봐야겠다.

<br>

## 2025.01.14 (화)
### ✅ TO DO
- API 명세서 작성
- ERD 설계
- BE 킥오프 회의
    - 코딩 & 깃 컨벤션 정리
    - 프로젝트 디렉토리 구조 정리
    - BE 내의 일정 대략적으로 정하기
    - 역할 분담
- 컨설턴트님과 코치님들과 미팅
- 미팅 피드백을 기반으로 기획 디벨롭 및 구체화

### 🔥 What I Learned
- 팀 미팅을 통해서 유저 리텐션을 어떻게 하면 더 올릴 수 있을지, 백엔드 개발자 측면에서 이번 프로젝트를 통해 가져갈 수 있는 챌린지 요소가 무엇인지 고민해볼 수 있었다.
- BE 챕터 킥오프 회의를 통해 사용자들에게 각종 카카오톡 알림을 보내주는 부분을 내가 맡게 되었다. 내가 생각했을 때는 단순히 카카오 오픈 API를 통해서 알림을 보내줄 수 있을 것이라고 생각하고 kakao developer 공식 문서에서 관련된 레퍼런스를 찾아보았다.
- 문서를 보며 처음 개념이 헷갈린 부분은 "카카오톡 메세지 보내기" 와 "카카오톡 공유하기" 였다.
- 내가 이해한 바로는 전자는 우리 서비스에서 톡으로 알림을 보내주어야 하는 이벤트가 발생했을 때 카카오톡을 보내주는 것이고, 후자는 우리 서비스에서는 내 선물함 링크를 친구들에게 공유할 때 필요한 기능이라고 생각했다.
- 하지만 데모를 진행해보니 후자에 대한 이해는 맞았지만, 전자는 내가 이해한 것과는 달리 나와 친구들에게 메세지를 보내는 것이었다.
    - 우리가 카카오톡을 보내는 케이스는 특정 유저들에게 공지성 알림을 보내기 위함이기 때문에 적합한 방안이 아니라고 판단했다.
- 이에 다른 API를 찾아봐야 한다는 것을 배울 수 있었던 시간이었다. 
    + 카카오톡 공유하기 API는 REST API는 지원하지 않고 javascript sdk만 지원하기 때문에 위에 말한 두 가지의 API 중 어떤 것을 채택할지 FE측과 논의해봐야겠다고 판단했다.

<br>

## 2025.01.13 (월)

### ✅ TO DO
- 기획 회의
- 회의한 내용을 바탕으로 와이어 프레임 러프하게 짜기
- 기능 명세서 작성

### 🔥 What I Learned
- 서비스를 '개발' 해오던 것과는 다르게, 서비스를 '기획'하는 것은 정말 어렵다는 것을 느꼈다...
- 단순히 어떤 기능을 구상하는 것을 넘어서, 그 기능의 목적을 생각하며 해당 목적을 달성하기 위해 그 기능이 과연 효과적이고 필요한지를 계속 점검하며 기획을 구체화 해나갈 수 있었다.
- 유저의 리텐션을 위한 기능들을 고민해보고, 와이어프레임을 짤 때도 사용자 친화적인 UX를 위해서는 어떤 구조와 뷰 플로우가 좋을지를 고민해보며 하나의 서비스를 제로부터 만들어나가는 것을 배울 수 있었다.

